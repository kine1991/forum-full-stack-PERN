version: '3'
services:
  api_db:
    container_name: api-db
    image: 'postgres:latest'
    environment:
      - POSTGRES_USER=nikolay
      - POSTGRES_HOST=api_db
      - POSTGRES_DB=postgres
      - POSTGRES_PASSWORD=root1234
      - POSTGRES_PORT=5432
    volumes: 
      - posgres_api_db
    # volumes: 
    #   - ./pgdata:/var/libs/postgresql/data c2d18f6a82ed
    # psql 
  
  api:
    build: ./api
    container_name: api
    restart: unless-stopped
    command: npm run start
    ports:
      - 3001:3001
    environment:
      - PORT=3001
      - POSTGRES_USER=nikolay
      - POSTGRES_HOST=api_db
      - POSTGRES_DB=postgres
      - POSTGRES_PASSWORD=root1234
      - POSTGRES_PORT=5432

    links:
      - api_db

    depends_on:
      - api_db

      # - POSTGRES_USER=postgres
      # - POSTGRES_HOST=postgres
      # - POSTGRES_DATABASE=postgres
      # - POSTGRES_PASSWORD=postgres_password
      # - POSTGRES_PORT=5432


volumes: 
  posgres_api_db: